# Промпт для генерации ЧТЗ с помощью ИИ

## Системный промпт

Используйте следующий системный промпт для настройки языковой модели:

```
Ты — эксперт по написанию технической документации для корпоративных ИТ-систем.
Твоя задача — создавать документы ЧТЗ (Частное техническое задание) в формате Markdown.

ФОРМАТ ДОКУМЕНТА:
Документ должен начинаться с YAML front matter в тройных дефисах (---).
После YAML идёт основной контент в формате Markdown.

ОБЯЗАТЕЛЬНЫЕ ПОЛЯ YAML:
- type: chtz
- metadata.shortName: краткое название изменения
- metadata.consultant.name: ФИО автора
- metadata.consultant.email: email автора
- metadata.organization: название организации заказчика
- metadata.createdDate: дата в формате DD.MM.YYYY

СТРУКТУРА ДОКУМЕНТА:
1. Термины и определения (директива :::terms)
2. Исходные данные задания
3. Изменение функционала системы (с таблицей :::changes-table)
4. Описание изменений в ИТ-системе (с таблицами :::function-table)
5. Описание изменений в интеграционных механизмах
6. Описание изменений, состава обрабатываемых ПДн
7. Входные формы
8. Выходные формы
9. Описание изменений в ролевой модели
10. Приложения

СПЕЦИАЛЬНЫЕ ДИРЕКТИВЫ:
- :::terms — таблица терминов
- :::changes-table — таблица "как есть / как будет"
- :::function-table{#id} — функциональная таблица с полями function, task, taskUrl, scenario
- :::note{type="warning"} — блок предупреждения
- :::empty-section — пустой раздел

ПРАВИЛА:
- Все разделы должны присутствовать (пустые разделы оформляй через :::empty-section)
- Функциональные таблицы должны содержать детальные сценарии
- Сценарии должны включать предусловия, основной и альтернативный сценарии
- Используй нумерованные списки для шагов сценария
- Используй **жирный** текст для выделения важных терминов
```

---

## Пример запроса пользователя

```
Создай ЧТЗ для следующей задачи:

Система: CRM
Задача: Добавить функцию массовой рассылки email клиентам
Автор: Сидоров Алексей (sidorov@company.ru)
Организация: ООО "ТехноПром"

Описание:
- Пользователь должен иметь возможность выбрать несколько клиентов
- Написать текст письма с использованием шаблонов
- Отправить письма всем выбранным клиентам
- Видеть статус отправки
- Ограничение: не более 1000 получателей за раз
```

---

## Ожидаемый ответ ИИ

```markdown
---
type: chtz
version: "1.0"

metadata:
  shortName: "Массовая рассылка email клиентам"
  consultant:
    name: "Сидоров Алексей"
    email: "sidorov@company.ru"
  organization: "ООО «ТехноПром»"
  itSolutions:
    - "CRM"
  itSystems:
    - "Модуль коммуникаций"
  processKT: false
  processPDn: true
  createdDate: "18.01.2025"

history:
  - version: "1.0"
    date: "18.01.2025"
    comment: "Первоначальная версия документа"
    author: "Сидоров А."
---

# 1. Термины, определения и сокращения

:::terms
| Термин | Определение |
|--------|-------------|
| CRM | Customer Relationship Management — система управления взаимоотношениями с клиентами |
| Email-рассылка | Массовая отправка электронных писем группе получателей |
| Шаблон письма | Заранее подготовленный текст письма с возможностью подстановки переменных |
:::

# 2. Исходные данные задания

В текущей версии CRM отсутствует функционал массовой рассылки email. Пользователи вынуждены отправлять письма каждому клиенту индивидуально, что занимает значительное время.

Цели изменения:
- Сократить время на коммуникацию с клиентами
- Обеспечить единообразие сообщений
- Предоставить инструменты отслеживания рассылок

# 3. Изменение функционала системы

## 3.1 Общее описание

Планируется разработка модуля массовой email-рассылки, интегрированного в существующую CRM-систему.

## 3.2 Описание функций «Как есть» / «Как будет»

:::changes-table
| Описание функции «Как есть» | Описание функции «Как будет» |
|-----------------------------|------------------------------|
| Отправка писем только индивидуально | Массовая отправка до 1000 получателей |
| Ручной ввод текста каждого письма | Использование готовых шаблонов |
| Нет информации о статусе отправки | Отображение статуса в реальном времени |
:::

# 4. Описание изменений в ИТ-системе

#### Таблица 1. Выбор получателей

:::function-table{#func-1}
function: Множественный выбор клиентов для рассылки
task: CRM-1001
taskUrl: https://jira.company.ru/browse/CRM-1001
scenario: |
  **Предусловия:**
  - Пользователь авторизован в CRM
  - Пользователь имеет роль "Менеджер по работе с клиентами"

  **Основной сценарий:**
  1. Пользователь переходит в раздел «Клиенты»
  2. Применяет фильтры для выбора целевой группы
  3. Отмечает чекбоксами нужных клиентов или нажимает «Выбрать всех»
  4. Нажимает кнопку «Email-рассылка»
  5. Система отображает количество выбранных получателей

  **Альтернативный сценарий:**
  - Если выбрано более 1000 клиентов:
    - Система отображает предупреждение
    - Предлагает разделить на несколько рассылок

  **Ограничения:**
  - Максимум 1000 получателей за одну рассылку
  - Только клиенты с заполненным email
:::

#### Таблица 2. Создание письма

:::function-table{#func-2}
function: Создание текста письма с использованием шаблонов
task: CRM-1002
taskUrl: https://jira.company.ru/browse/CRM-1002
scenario: |
  **Предусловия:**
  - Выбраны получатели рассылки

  **Основной сценарий:**
  1. Система отображает форму создания письма
  2. Пользователь выбирает шаблон из списка или создаёт новый
  3. Редактирует текст письма в WYSIWYG-редакторе
  4. Вставляет переменные (имя клиента, компания и т.д.)
  5. Просматривает предварительный просмотр
  6. Нажимает «Отправить»

  **Доступные переменные:**
  - {{client_name}} — имя клиента
  - {{company}} — название компании
  - {{manager}} — имя менеджера
:::

#### Таблица 3. Отслеживание статуса

:::function-table{#func-3}
function: Отображение статуса отправки рассылки
task: CRM-1003
taskUrl: https://jira.company.ru/browse/CRM-1003
scenario: |
  **Основной сценарий:**
  1. После запуска рассылки отображается прогресс-бар
  2. Система показывает:
     - Отправлено: X из Y
     - Успешно: N
     - Ошибок: M
  3. По завершении отображается итоговый отчёт
  4. Отчёт сохраняется в истории рассылок
:::

# 5. Описание изменений в интеграционных механизмах

Интеграция со следующими системами:
- **SMTP-сервер** — для отправки писем
- **Сервис аналитики** — для отслеживания открытий писем

# 6. Описание изменений, состава обрабатываемых ПДн

:::empty-section
Изменения в составе обрабатываемых ПДн отсутствуют.
:::

# 7. Входные формы

Основные входные формы:
- Форма выбора получателей рассылки
- Форма создания письма (WYSIWYG-редактор)
- Форма управления шаблонами писем

:::note{type="warning"}
**Внимание:** Интерфейс должен соответствовать дизайн-системе CRM версии 2.0.
:::

# 8. Выходные формы

Добавить отчёт «История email-рассылок» с полями:
- Дата рассылки
- Автор
- Количество получателей
- Статус (успешно/с ошибками)

# 9. Описание изменений в ролевой модели

Новые права доступа:

| Право | Описание |
|-------|----------|
| EMAIL_MASS_SEND | Отправка массовых рассылок |
| EMAIL_TEMPLATE_MANAGE | Управление шаблонами писем |

# 10. Приложения

## 10.1 Макеты интерфейса

Макеты будут предоставлены после утверждения ЧТЗ.
```

---

## Советы по использованию

### 1. Давайте контекст

Чем больше деталей вы предоставите, тем точнее будет результат:
- Название системы
- Роли пользователей
- Существующий функционал
- Ограничения
- Интеграции

### 2. Уточняйте требования

После первой генерации просите ИИ:
- Добавить альтернативные сценарии
- Уточнить ограничения
- Расширить раздел интеграции

### 3. Проверяйте результат

Всегда проверяйте:
- Корректность YAML (формат дат, обязательные поля)
- Полноту сценариев
- Соответствие реальным требованиям
- Отсутствие citation-артефактов (fileciteturn1file0 и подобных)
- Корректность `taskUrl` (только реальные http:// или https:// URL, или поле не указано)

### 4. Важные правила для AI

⚠️ При генерации документа ИИ должна следовать правилам:

- **taskUrl** — указывайте только реальные URL (http:// или https://), либо не указывайте это поле вообще. **НЕ используйте `taskUrl: "—"`**
- **Citation-артефакты** — удаляйте все артефакты типа `fileciteturn1file0` из финального документа. Они должны отсутствовать в результате.
- **Номера задач** — не выдумывайте номера задач в трекере, используйте только те, что предоставил пользователь

### 5. Итеративно улучшайте

```
Добавь в раздел 4.1.1:
- Возможность сохранения выборки клиентов
- Загрузку списка из Excel-файла
```

---

## Шаблон запроса

```
Создай ЧТЗ для:

**Система:** [Название системы]
**Задача:** [Краткое описание]
**Автор:** [ФИО] ([email])
**Организация:** [Название]

**Описание функционала:**
- [Пункт 1]
- [Пункт 2]
- [Пункт 3]

**Ограничения:**
- [Ограничение 1]
- [Ограничение 2]

**Интеграции:**
- [Система 1]
- [Система 2]
```
