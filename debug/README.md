# Debug Scripts

Отладочные скрипты для анализа DOCX файлов и тестирования конвертера.

## Скрипты анализа

### analyze-heading-runs.js
Анализирует структуру text runs в заголовках таблиц.

**Использование:**
```bash
node debug/analyze-heading-runs.js
```

**Что делает:**
- Находит все заголовки с "Таблица" и "Подписание"
- Показывает структуру runs (w:r элементов)
- Отображает xml:space="preserve" атрибуты
- Помогает понять, почему пропадают пробелы

### debug-br-extraction.js
Проверяет, создаются ли множественные параграфы в ячейках таблиц при наличии `<br>` тегов.

**Использование:**
```bash
node debug/debug-br-extraction.js [path-to-docx]
```

**Что делает:**
- Парсит DOCX файл
- Находит все таблицы
- Показывает ячейки с несколькими параграфами
- Выводит текст каждого параграфа

### find-nested-tables.js
Находит и анализирует вложенные таблицы в DOCX документе.

**Использование:**
```bash
node debug/find-nested-tables.js [path-to-docx]
```

**Что делает:**
- Ищет все таблицы внутри ячеек таблиц (w:tbl внутри w:tc)
- Показывает структуру вложенных таблиц
- Выводит количество строк и колонок
- Помогает проверить поддержку nested tables

### check-raw-xml.js
Извлекает и показывает raw XML фрагменты из DOCX.

**Использование:**
```bash
node debug/check-raw-xml.js [path-to-docx]
```

**Что делает:**
- Находит таблицы по тексту заголовков
- Показывает prettified XML структуру
- Полезно для низкоуровневой отладки

## Отчеты

В директории `reports/` сохранены подробные отчеты анализа:

- **nested-tables-report.md** - полный отчет о структуре вложенных таблиц
- **nested-tables-summary.txt** - краткая сводка по вложенным таблицам
- **raw-xml-analysis.txt** - анализ raw XML структуры

## Примеры использования

### Проверить, сохраняются ли пробелы
```bash
node debug/analyze-heading-runs.js
```

### Проверить создание параграфов из <br>
```bash
node debug/debug-br-extraction.js test-br-tags.docx
```

### Найти все вложенные таблицы
```bash
node debug/find-nested-tables.js "tests/test1-original/Очередь1_*.docx"
```
